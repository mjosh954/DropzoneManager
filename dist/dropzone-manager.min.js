var DropzoneManager=function(){"use strict";function e(r){if(!(this instanceof e))return new e(r);this.dropzones={},r&&r.length>0&&r.forEach(function(e){this.self.register(e)})}function r(e){e.isRegistered=!0}function n(e){return e?e instanceof Dropzone:!1}function o(e,r){if(!e)throw new Error("Missing dropzones parameter.");if(!r)throw new Error("Missing id parameter");return"undefined"!==e[r]&&n(e[r])&&e[r].isRegistered}return e.prototype.register=function(e,o){return n(e)?(r(e),this.dropzones[e.options.id]=e,o(null,e)):o(new Error("Not a valid dropzone to register"))},e.prototype.processAll=function(e,r){var n={order:"ASC",unregister:!1};if(r||"function"!=typeof e||(r=e,e=n),e=e||n,!this.hasRegisteredDropzones())return r(new Error("Manager has no dropzones registered"));var t=Object.keys(this.dropzones),s=[];return t.forEach(function(r){o(r)&&this.processById(r,function(n,o){n||(s.push(o),e.unregister&&this.removeById({id:r}))})}),r(null,s)},e.prototype.processById=function(e,r){if(r&&"function"==typeof r||(r=function(){}),!this.hasRegisteredDropzones())return r(new Error("Manager has no dropzones registered"));if(!o(this.dropzones,e.id))return r(new Error('"'+e.id+'" is not a registered Dropzone'));var n=this.dropzones[e.id];return n.processQueue(),e.postUnregister&&(this.dropzones[e.id].isRegistered=!1),r(null,n)},e.prototype.removeById=function(e,r){if(r&&"function"==typeof r||(r=function(){}),!this.hasRegisteredDropzones())return r(new Error("Manager has no dropzones registered"),null);if(o(this.dropzones,e.id))return r(new Error('"'+e.id+'" is not a registered Dropzone'));var n=this.dropzones[e.id];return e.retainInstance===!0?this.dropzpones[e.id].isRegistered=!1:delete this.dropzones[e.id],r(null,n)},e.prototype.unregisterAll=function(e,r){var n={retainInstance:!1};if(r||"function"!=typeof e||(r=e,e=n),!this.hasRegisteredDropzones())return r(new Error("Manager has no dropzones registered."));e=e||n;var t=JSON.parse(JSON.stringify(this.dropzones));if(e.retainDropzones&&e.retainInstance===!1)this.dropzones={};else{var s=Object.keys(this.dropzones),i=[];s.forEach(function(e){if(o(e)){var r=this.dropzones[e].isRegistered=!1;i.push(r)}})}return r(null,t)},e.prototype.hasAnyQueuedFiles=function(){var e=!1;if(this.hasRegisteredDropzones()){var r=Object.keys(this.dropzones);r.forEach(function(r){o(r)&&this.dropzones[r].files.forEach(function(r){return"queued"===r.status?void(e=!0):void 0}),e})}return e},e.prototype.hasRegisteredDropzones=function(){var e=Object.keys(this.dropzones);return 0===e.length?!1:(e.forEach(function(e){var r=this.dropzones[e];return r.isRegistered?!0:void 0}),!1)},e.createDropzone=function(e,r){var n=new Dropzone(e,r);return n},e}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3B6b25lLW1hbmFnZXIuanMiXSwibmFtZXMiOlsiRHJvcHpvbmVNYW5hZ2VyIiwiZHJvcHpvbmVzIiwidGhpcyIsImxlbmd0aCIsImZvckVhY2giLCJkcm9wem9uZSIsInNlbGYiLCJyZWdpc3RlciIsImluaXREcm9wem9uZSIsImlzUmVnaXN0ZXJlZCIsImlzRHJvcHpvbmVJbnN0YW5jZSIsIkRyb3B6b25lIiwiaWQiLCJFcnJvciIsInByb3RvdHlwZSIsImNhbGxiYWNrIiwib3B0aW9ucyIsInByb2Nlc3NBbGwiLCJkZWZhdWx0T3B0aW9ucyIsIm9yZGVyIiwidW5yZWdpc3RlciIsImhhc1JlZ2lzdGVyZWREcm9wem9uZXMiLCJpZHMiLCJPYmplY3QiLCJrZXlzIiwicHJvY2Vzc0J5SWQiLCJlcnIiLCJwdXNoIiwicmVtb3ZlQnlJZCIsInBhcmFtcyIsInByb2Nlc3NlZERyb3B6b25lIiwicHJvY2Vzc1F1ZXVlIiwicG9zdFVucmVnaXN0ZXIiLCJyZW1vdmVkRHJvcHpvbmUiLCJyZXRhaW5JbnN0YW5jZSIsImRyb3B6cG9uZXMiLCJ1bnJlZ2lzdGVyQWxsIiwidW5yZWdpc3RlcmVkRHJvcHpvbmVzIiwiSlNPTiIsInBhcnNlIiwic3RyaW5naWZ5IiwicmV0YWluRHJvcHpvbmVzIiwiaGFzQW55UXVldWVkRmlsZXMiLCJoYXNRdWV1ZWQiLCJmaWxlcyIsImZpbGUiLCJzdGF0dXMiLCJrZXkiLCJkeiIsImNyZWF0ZURyb3B6b25lIiwibmV3RHJvcHpvbmUiXSwibWFwcGluZ3MiOiJBQUNBLEdBQUFBLGlCQUFBLFdBQ0EsWUFFQSxTQUFBQSxHQUFBQyxHQUNBLEtBQUFDLGVBQUFGLElBQ0EsTUFBQSxJQUFBQSxHQUFBQyxFQUdBQyxNQUFBRCxhQUVBQSxHQUFBQSxFQUFBRSxPQUFBLEdBQ0FGLEVBQUFHLFFBQUEsU0FBQUMsR0FDQUgsS0FBQUksS0FBQUMsU0FBQUYsS0ErQkEsUUFBQUcsR0FBQUgsR0FHQUEsRUFBQUksY0FBQSxFQW9OQSxRQUFBQyxH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dEIsTUFLQSxNQUFBVSxHQUFBLEtBQUFzQixJQVVBckMsRUFBQWMsVUFBQTRCLGtCQUFBLFdBQ0EsR0FBQUMsSUFBQSxDQUdBLElBQUF6QyxLQUFBbUIseUJBQUEsQ0FDQSxHQUFBQyxHQUFBQyxPQUFBQyxLQUFBdEIsS0FBQUQsVUFFQXFCLEdBQUFsQixRQUFBLFNBQUFRLEdBQ0FILEVBQUFHLElBQ0FWLEtBQUFELFVBQUFXLEdBQUFnQyxNQUFBeEMsUUFBQSxTQUFBeUMsR0FDQSxNQUFBLFdBQUFBLEVBQUFDLFlBQ0FILEdBQUEsR0FEQSxTQU9BQSxJQUlBLE1BQUFBLElBU0EzQyxFQUFBYyxVQUFBTyx1QkFBQSxXQUNBLEdBQUFHLEdBQUFELE9BQUFDLEtBQUF0QixLQUFBRCxVQUVBLE9BQUEsS0FBQXVCLEVBQUFyQixRQUNBLEdBRUFxQixFQUFBcEIsUUFBQSxTQUFBMkMsR0FDQSxHQUFBQyxHQUFBOUMsS0FBQUQsVUFBQThDLEVBQ0EsT0FBQUMsR0FBQXZDLGNBQ0EsRUFEQSxVQUlBLElBU0FULEVBQUFpRCxlQUFBLFNBQUFyQyxFQUFBSSxHQUVBLEdBQUFrQyxHQUFBLEdBQUF2QyxVQUFBQyxFQUFBSSxFQUVBLE9BQUFrQyxJQW9CQWxEIiwiZmlsZSI6ImRyb3B6b25lLW1hbmFnZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbnZhciBEcm9wem9uZU1hbmFnZXIgPSAoZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cclxuXHRmdW5jdGlvbiBEcm9wem9uZU1hbmFnZXIoZHJvcHpvbmVzKSB7XHJcblx0XHRpZighKHRoaXMgaW5zdGFuY2VvZiBEcm9wem9uZU1hbmFnZXIpKVxyXG5cdFx0XHRyZXR1cm4gbmV3IERyb3B6b25lTWFuYWdlcihkcm9wem9uZXMpO1xyXG5cdFx0XHJcblx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHR0aGlzLmRyb3B6b25lcyA9IHt9O1xyXG5cclxuXHRcdGlmKGRyb3B6b25lcyAmJiBkcm9wem9uZXMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRkcm9wem9uZXMuZm9yRWFjaChmdW5jdGlvbihkcm9wem9uZSkge1xyXG5cdFx0XHRcdHRoaXMuc2VsZi5yZWdpc3Rlcihkcm9wem9uZSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0XHJcblx0LyoqXHJcblx0KlxyXG5cdCogQWRkcyBhIGRyb3B6b25lIHRvIHRoZSBtYW5hZ2VyXHJcblx0KlxyXG5cdCoqL1xyXG5cdERyb3B6b25lTWFuYWdlci5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbihkcm9wem9uZSwgY2FsbGJhY2spIHtcclxuXHJcblx0XHRpZighaXNEcm9wem9uZUluc3RhbmNlKGRyb3B6b25lKSlcclxuXHRcdHtcclxuXHRcdFx0cmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcignTm90IGEgdmFsaWQgZHJvcHpvbmUgdG8gcmVnaXN0ZXInKSk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGluaXREcm9wem9uZShkcm9wem9uZSk7IC8vIGluaXRpYWxpemUgdGhlIG5ldyBkcm9wem9uZSwgdGhlbiBhZGRcclxuXHJcblx0XHR0aGlzLmRyb3B6b25lc1tkcm9wem9uZS5vcHRpb25zLmlkXSA9IGRyb3B6b25lOyAvLyBhZGQgdG8gZGljdGlvbmFyeVxyXG5cdFx0XHJcblx0XHRyZXR1cm4gY2FsbGJhY2sobnVsbCwgZHJvcHpvbmUpO1xyXG5cdH07XHJcblxyXG5cclxuXHQvKipcclxuXHQqXHJcblx0KiBBZGQgaXNSZWdpc3RlcmVkIHByb3BlcnR5IG9uIGRyb3B6b25lIG9iamVjdCwgXHJcblx0KlxyXG5cdCoqL1xyXG5cdGZ1bmN0aW9uIGluaXREcm9wem9uZShkcm9wem9uZSkge1xyXG5cdFx0Ly8gTk9URTogYWRkIGFkZGl0aW9uYWwgJ2RlZmF1bHQnIHByb3BlcnRpZXNcclxuXHRcdC8vIG9uIHRoZSBkcm9wem9uZSBvYmplY3RcclxuXHRcdGRyb3B6b25lLmlzUmVnaXN0ZXJlZCA9IHRydWU7IFxyXG5cdH1cclxuXHJcblxyXG5cdC8qKlxyXG5cdCpcclxuXHQqIFByb2Nlc3NlcyBhbGwgcmVnaXN0ZXJlZCBkcm9wem9uZXMgd2l0aCBxdWV1ZWQgZmlsZXMgZm9yIHVwbG9hZC4gXHJcblx0KlxyXG5cdCoqL1xyXG5cdERyb3B6b25lTWFuYWdlci5wcm90b3R5cGUucHJvY2Vzc0FsbCA9IGZ1bmN0aW9uKG9wdGlvbnMsIGNhbGxiYWNrKSB7IC8vIFRPRE8gYWRkIG9wdGlvbiB0byB1bnJlZ2lzdGVyIHBvc3QgcHJvY2Vzc1xyXG5cdFx0Ly8gRGVmYXVsdCBvcHRpb25zIGlmIG5vbmUgcGFzc2VkXHJcblx0XHR2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XHJcblx0XHRcdG9yZGVyOiAnQVNDJyxcclxuXHRcdFx0dW5yZWdpc3RlciA6IGZhbHNlXHJcblx0XHR9O1xyXG5cclxuXHRcdGlmKCFjYWxsYmFjayAmJiB0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xyXG5cdFx0XHRjYWxsYmFjayA9IG9wdGlvbnM7XHJcblx0XHRcdG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcclxuXHRcdH1cclxuXHJcblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCBkZWZhdWx0T3B0aW9ucztcclxuXHJcblx0XHRpZighdGhpcy5oYXNSZWdpc3RlcmVkRHJvcHpvbmVzKCkpXHJcblx0XHRcdHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoXCJNYW5hZ2VyIGhhcyBubyBkcm9wem9uZXMgcmVnaXN0ZXJlZFwiKSk7XHJcblxyXG5cdFx0dmFyIGlkcyA9IE9iamVjdC5rZXlzKHRoaXMuZHJvcHpvbmVzKTtcclxuXHRcdHZhciBkcm9wem9uZXMgPSBbXTtcclxuXHJcblx0XHQvLyBUT0RPIGFkZCBwcm9jZXNzIG9yZGVyIEFTQyBhbmQgREVTQ1xyXG5cdFx0aWRzLmZvckVhY2goZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0Ly8gY2hlY2sgaWYgdGhlIGRyb3B6b25lIGlzIHJlZ2lzdGVyZWQgd2l0aCBpZFxyXG5cdFx0XHRpZihpc1JlZ2lzdGVyZWQoaWQpKSBcclxuXHRcdFx0XHR0aGlzLnByb2Nlc3NCeUlkKGlkLCBmdW5jdGlvbihlcnIsIGRyb3B6b25lKSB7XHJcblx0XHRcdFx0XHRpZighZXJyKSB7IFxyXG5cdFx0XHRcdFx0XHRkcm9wem9uZXMucHVzaChkcm9wem9uZSk7IFxyXG5cdFx0XHRcdFx0XHRpZihvcHRpb25zLnVucmVnaXN0ZXIpIHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnJlbW92ZUJ5SWQoeyBpZDogaWQgfSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIGdldCBjb2xsZWN0aW9uIG9mIGRyb3B6b25lcyB0aGF0IHdlcmUgcHJvY2Vzc2VkXHJcblx0XHQvLyBwYXNzIGluIGNhbGxiYWNrXHJcblx0XHRyZXR1cm4gY2FsbGJhY2sobnVsbCwgZHJvcHpvbmVzKTtcclxuXHR9O1xyXG5cclxuXHJcblx0LyoqXHJcblx0KlxyXG5cdCogUHJvY2Vzc2VzIHRoZSBxdWV1ZSBvZiBhIHNwZWNpZmljIHJlZ2lzdGVyZWQgZHJvcHpvbmUgd2l0aCBpZFxyXG5cdCpcclxuXHQqKi9cclxuXHREcm9wem9uZU1hbmFnZXIucHJvdG90eXBlLnByb2Nlc3NCeUlkID0gZnVuY3Rpb24ocGFyYW1zLCBjYWxsYmFjaykgeyAvLyBUT0RPIGFkZCBvcHRpb24sIGV4LiB1bnJlZ2lzdGVyIGFmdGVyIHByb2Nlc3NcclxuXHRcdGlmKCFjYWxsYmFjayB8fCB0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0Y2FsbGJhY2sgPSBmdW5jdGlvbihlcnIsIGRyb3B6b25lKSB7IH07XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoIXRoaXMuaGFzUmVnaXN0ZXJlZERyb3B6b25lcygpKVxyXG5cdFx0XHRyZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKFwiTWFuYWdlciBoYXMgbm8gZHJvcHpvbmVzIHJlZ2lzdGVyZWRcIikpO1xyXG5cclxuXHRcdGlmKCFpc1JlZ2lzdGVyZWQodGhpcy5kcm9wem9uZXMsIHBhcmFtcy5pZCkpXHJcblx0XHRcdHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoJ1wiJyArIHBhcmFtcy5pZCArICdcIiBpcyBub3QgYSByZWdpc3RlcmVkIERyb3B6b25lJykpO1xyXG5cclxuXHRcdHZhciBwcm9jZXNzZWREcm9wem9uZSA9IHRoaXMuZHJvcHpvbmVzW3BhcmFtcy5pZF07XHJcblx0XHRwcm9jZXNzZWREcm9wem9uZS5wcm9jZXNzUXVldWUoKTtcclxuXHRcdGlmKHBhcmFtcy5wb3N0VW5yZWdpc3Rlcil7XHJcblx0XHRcdHRoaXMuZHJvcHpvbmVzW3BhcmFtcy5pZF0uaXNSZWdpc3RlcmVkID0gZmFsc2U7IC8vIHVucmVnaXN0ZXIgaWYgcGFyYW0gcG9zdCB1bnJlZ2lzdGVyIGlzIHRydWVcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gY2FsbGJhY2sobnVsbCwgcHJvY2Vzc2VkRHJvcHpvbmUpOyAvLyByZXR1cm4gcHJvY2Vzc2VkIGRyb3B6b25lXHJcblx0fTtcclxuXHJcblxyXG5cdC8qKlxyXG5cdCpcclxuXHQqIENsZWFycyBvdXQgdGhlIG1hbmFnZXIgb2YgcmVnaXN0ZXJlZCBkcm9wem9uZSB3aXRoIHNwZWNpZmllZCBpZFxyXG5cdCpcclxuXHQqKi9cclxuXHREcm9wem9uZU1hbmFnZXIucHJvdG90eXBlLnJlbW92ZUJ5SWQgPSBmdW5jdGlvbihwYXJhbXMsIGNhbGxiYWNrKSB7IC8vIFRPRE8gYWRkIHJldGFpbkRaIGluc3RhbmNlIG9wdGlvblxyXG5cdFx0aWYoIWNhbGxiYWNrIHx8IHR5cGVvZiBjYWxsYmFjayAhPT0gJ2Z1bmN0aW9uJykge1xyXG5cdFx0XHRjYWxsYmFjayA9IGZ1bmN0aW9uKGVyciwgZHJvcHpvbmUpIHsgfTtcclxuXHRcdH1cclxuXHJcblx0XHRpZighdGhpcy5oYXNSZWdpc3RlcmVkRHJvcHpvbmVzKCkpXHJcblx0XHRcdHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoJ01hbmFnZXIgaGFzIG5vIGRyb3B6b25lcyByZWdpc3RlcmVkJyksIG51bGwpO1xyXG5cclxuXHRcdC8vIFRPRE8gZmluaXNoXHJcblx0XHQvLyBDaGVjayBpZiBpZCBpcyByZWdpc3RlcmVkIFxyXG5cdFx0aWYoaXNSZWdpc3RlcmVkKHRoaXMuZHJvcHpvbmVzLCBwYXJhbXMuaWQpKVxyXG5cdFx0XHRyZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCdcIicgKyBwYXJhbXMuaWQgKyAnXCIgaXMgbm90IGEgcmVnaXN0ZXJlZCBEcm9wem9uZScpKTtcclxuXHJcblx0XHR2YXIgcmVtb3ZlZERyb3B6b25lID0gdGhpcy5kcm9wem9uZXNbcGFyYW1zLmlkXTtcclxuXHRcdFxyXG5cdFx0aWYocGFyYW1zLnJldGFpbkluc3RhbmNlID09PSB0cnVlKSB7XHJcblx0XHRcdHRoaXMuZHJvcHpwb25lc1twYXJhbXMuaWRdLmlzUmVnaXN0ZXJlZCA9IGZhbHNlOyAvLyBrZWVwIGluIGNvbGxlY3Rpb24sIHJlbW92ZSByZWdpc3RlcmVkIGZsYWdcclxuXHRcdH0gZWxzZSB7IFxyXG5cdFx0XHRkZWxldGUgdGhpcy5kcm9wem9uZXNbcGFyYW1zLmlkXTsgLy8gcmVtb3ZlIGZyb20gY29sbGVjdGlvblxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBjYWxsYmFjayhudWxsLCByZW1vdmVkRHJvcHpvbmUpO1xyXG5cdH07XHJcblxyXG5cclxuXHQvKipcclxuXHQqIFxyXG5cdCogQ2xlYXJzIG91dCB0aGUgbWFuYWdlciBvZiBhbGwgZHJvcHpvbmVzIHJlZ2lzdGVyZWQgd2l0aCBjYWxsYmFjayByZXR1cm5pbmcgdGhlIGRyb3B6b25lc1xyXG5cdCogTygxKVxyXG5cdCogXHJcblx0KiovXHJcblx0RHJvcHpvbmVNYW5hZ2VyLnByb3RvdHlwZS51bnJlZ2lzdGVyQWxsID0gZnVuY3Rpb24ob3B0aW9ucywgY2FsbGJhY2spIHtcclxuXHRcdFxyXG5cdFx0dmFyIGRlZmF1bHRPcHRpb25zID0ge1xyXG5cdFx0XHRyZXRhaW5JbnN0YW5jZSA6IGZhbHNlXHJcblx0XHR9O1xyXG5cclxuXHRcdGlmKCFjYWxsYmFjayAmJiB0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJyl7XHJcblx0XHRcdGNhbGxiYWNrID0gb3B0aW9ucztcclxuXHRcdFx0b3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCF0aGlzLmhhc1JlZ2lzdGVyZWREcm9wem9uZXMoKSkgXHJcblx0XHRcdHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoJ01hbmFnZXIgaGFzIG5vIGRyb3B6b25lcyByZWdpc3RlcmVkLicpKTtcclxuXHRcdFxyXG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwgZGVmYXVsdE9wdGlvbnM7XHJcblxyXG5cdFx0dmFyIHVucmVnaXN0ZXJlZERyb3B6b25lcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5kcm9wem9uZXMpKTsgLy8gY3JlYXRlIGFuIHVucmVmZXJlbmNlZCBjb3B5XHJcblx0XHRcclxuXHRcdGlmKG9wdGlvbnMucmV0YWluRHJvcHpvbmVzICYmIG9wdGlvbnMucmV0YWluSW5zdGFuY2UgPT09IGZhbHNlKXsgLy8gcmVtb3ZlIGFsbCB0cmFjZSBvZiBkcm9wem9uZXNcclxuXHRcdFx0dGhpcy5kcm9wem9uZXMgPSB7fTsgLy8gcmVzZXQgdG8gZW1wdHkgb2JqZWN0IGRpY3Rpb25hcnlcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHR2YXIgaWRzID0gT2JqZWN0LmtleXModGhpcy5kcm9wem9uZXMpO1xyXG5cdFx0XHR2YXIgZHJvcHpvbmVzID0gW107XHJcblx0XHRcdGlkcy5mb3JFYWNoKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0Ly8gY2hlY2sgaWYgdGhlIGRyb3B6b25lIGlzIHJlZ2lzdGVyZWQgd2l0aCBpZFxyXG5cdFx0XHRcdGlmKGlzUmVnaXN0ZXJlZChpZCkpIHtcclxuXHRcdFx0XHRcdHZhciBkcm9wem9uZSA9IHRoaXMuZHJvcHpvbmVzW2lkXS5pc1JlZ2lzdGVyZWQgPSBmYWxzZTtcclxuXHRcdFx0XHRcdGRyb3B6b25lcy5wdXNoKGRyb3B6b25lKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBjYWxsYmFjayhudWxsLCB1bnJlZ2lzdGVyZWREcm9wem9uZXMpOyAvLyByZXR1cm4gYWxsIGRyb3B6b25lcyB0aGF0IGdvdCByZW1vdmVkXHJcblx0fTtcclxuXHJcblxyXG5cdC8qKlxyXG5cdCpcclxuXHQqIENoZWNrcyBpZiBhbnkgZHJvcHpvbmUgaW4gdGhlIG1hbmFnZXIgaGFzIHBlbmRpbmcgZmlsZXMgZm9yIHVwbG9hZFxyXG5cdCogTyhuKVxyXG5cdCogXHJcblx0KiovXHJcblx0RHJvcHpvbmVNYW5hZ2VyLnByb3RvdHlwZS5oYXNBbnlRdWV1ZWRGaWxlcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGhhc1F1ZXVlZCA9IGZhbHNlO1xyXG5cclxuXHRcdC8vIENoZWNrIGlmIHRoZXJlJ3MgYW55IHJlZ2lzdGVyZWQgZHJvcHpvbmVzIGZpcnN0LiBSZXR1cm4gZmFsc2UgaWYgbm9uZS5cclxuXHRcdGlmKHRoaXMuaGFzUmVnaXN0ZXJlZERyb3B6b25lcygpKSB7XHJcblx0XHRcdHZhciBpZHMgPSBPYmplY3Qua2V5cyh0aGlzLmRyb3B6b25lcyk7IC8vIGdldCBhbGwgdGhlIGtleXNcclxuXHJcblx0XHRcdGlkcy5mb3JFYWNoKGZ1bmN0aW9uKGlkKSB7XHJcblx0XHRcdFx0aWYoaXNSZWdpc3RlcmVkKGlkKSkge1xyXG5cdFx0XHRcdFx0dGhpcy5kcm9wem9uZXNbaWRdLmZpbGVzLmZvckVhY2goZnVuY3Rpb24oZmlsZSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoZmlsZS5zdGF0dXMgPT09IFwicXVldWVkXCIpIHtcclxuXHRcdFx0ICAgICAgICAgICAgICAgIGhhc1F1ZXVlZCA9IHRydWU7XHJcblx0XHRcdCAgICAgICAgICAgICAgICByZXR1cm47XHJcblx0XHQgICAgICAgICAgICBcdH0gICAgICAgICAgICBcdFx0XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmKGhhc1F1ZXVlZCkgcmV0dXJuO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHJcblx0ICAgIHJldHVybiBoYXNRdWV1ZWQ7XHJcblx0fTtcclxuXHJcblxyXG5cdC8qKlxyXG5cdCpcclxuXHQqIENoZWNrIGZvciBhbnkgZHJvcHpvbmVzIGluIG1hbmFnZXJcclxuXHQqXHJcblx0KiovXHJcblx0RHJvcHpvbmVNYW5hZ2VyLnByb3RvdHlwZS5oYXNSZWdpc3RlcmVkRHJvcHpvbmVzID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuZHJvcHpvbmVzKTtcclxuXHJcblx0XHRpZihrZXlzLmxlbmd0aCA9PT0gMClcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cclxuXHRcdGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcclxuXHRcdFx0dmFyIGR6ID0gdGhpcy5kcm9wem9uZXNba2V5XTtcclxuXHRcdFx0aWYoZHouaXNSZWdpc3RlcmVkKSBcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTsgLy8gcmV0dXJuIG9uIGZpcnN0IGluc3RhbmNlIG9mIGEgcmVnaXN0ZXJlZCBkcm9wem9uZVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH07XHJcblxyXG5cclxuXHQvKipcclxuXHQqXHJcblx0KiBGYWN0b3J5IG1ldGhvZCB0byBjcmVhdGUgZHJvcHpvbmVzXHJcblx0KlxyXG5cdCoqL1xyXG5cdERyb3B6b25lTWFuYWdlci5jcmVhdGVEcm9wem9uZSA9IGZ1bmN0aW9uKGlkLCBvcHRpb25zKSB7XHJcblx0XHQvLyBUT0RPIFByb3h5IHRvIGFkZCBhZGRpdGlvbmFsIHByb3BlcnRpZXMgYW5kIHZhbGlkYXRpb25cclxuXHRcdHZhciBuZXdEcm9wem9uZSA9IG5ldyBEcm9wem9uZShpZCwgb3B0aW9ucyk7XHJcblxyXG5cdFx0cmV0dXJuIG5ld0Ryb3B6b25lO1xyXG5cdH07XHJcblxyXG5cdGZ1bmN0aW9uIGlzRHJvcHpvbmVJbnN0YW5jZShkcm9wem9uZSkge1xyXG5cdFx0aWYoIWRyb3B6b25lKSByZXR1cm4gZmFsc2U7XHJcblx0XHRyZXR1cm4gKGRyb3B6b25lIGluc3RhbmNlb2YgRHJvcHpvbmUpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0KlxyXG5cdCogQ2hlY2sgaWYgZHJvcHpvbmUgaXMgcmVnaXN0ZXJlZCB3aXRoIHRoYXQgaWQuXHJcblx0KlxyXG5cdCoqL1xyXG5cdGZ1bmN0aW9uIGlzUmVnaXN0ZXJlZChkcm9wem9uZXMsIGlkKSB7XHJcblx0XHRpZighZHJvcHpvbmVzKSB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZHJvcHpvbmVzIHBhcmFtZXRlci4nKTtcclxuXHRcdGlmKCFpZCkgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGlkIHBhcmFtZXRlcicpO1xyXG5cclxuXHRcdHJldHVybiBkcm9wem9uZXNbaWRdICE9PSBcInVuZGVmaW5lZFwiICYmIGlzRHJvcHpvbmVJbnN0YW5jZShkcm9wem9uZXNbaWRdKSAmJiBkcm9wem9uZXNbaWRdLmlzUmVnaXN0ZXJlZDtcclxuXHR9XHJcblxyXG5cdHJldHVybiBEcm9wem9uZU1hbmFnZXI7XHJcblxyXG59KSgpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=