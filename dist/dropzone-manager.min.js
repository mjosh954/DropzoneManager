var DropzoneManager=function(){"use strict";function e(r){return this instanceof e?(this.self=this,this.dropzones={},void(r&&r.length>0&&r.forEach(function(e){this.self.register(e)}))):new e(r)}function r(e){e.isRegistered=!0}function n(e){return e instanceof Dropzone}function o(e,r){return"undefined"!==e[r]&&n(e[r])}return e.prototype.register=function(e,o){return o&&"function"===o||(o=function(){}),n(e)?(r(e),this.dropzones[e.options.id]=e,o(null,e)):o(new Error("Not a valid dropzone to register"))},e.prototype.processAll=function(e,r){if(r||"function"!=typeof e||(r=e,e={order:"ASC",unregister:!1}),!this.hasRegisteredDropzones())return r(new Error("Manager has no dropzones registered"));var n=Object.keys(this.dropzones),t=[];return n.forEach(function(r){o(r)&&this.processById(r,function(n,o){n||t.push(o),e.unregister&&this.removeById({id:r})})}),r(null,t)},e.prototype.processById=function(e,r){if(r&&"function"==typeof r||(r=function(){}),!this.hasRegisteredDropzones())return r(new Error("Manager has no dropzones registered"));if(!o(this.dropzones,e.id))return r(new Error('"'+e.id+'" is not a registered Dropzone'));var n=this.dropzones[e.id];return n.processQueue(),e.postUnregister&&(this.dropzones[e.id].isRegistered=!1),r(null,n)},e.prototype.removeById=function(e,r){if(r&&"function"==typeof r||(r=function(){}),!this.hasRegisteredDropzones())return r(new Error("Manager has no dropzones registered"),null);if(o(this.dropzones,e.id))return r(new Error('"'+e.id+'" is not a registered Dropzone'));var n=this.dropzones[e.id];return e.retainInstance===!0?this.dropzpones[e.id].isRegistered=!1:delete this.dropzones[e.id],r(null,n)},e.prototype.unregisterAll=function(e,r){if(r||"function"!=typeof e||(r=e,e={retainInstance:!1}),!this.hasRegisteredDropzones())return r(new Error("Manager has no dropzones registered."));var n=JSON.parse(JSON.stringify(this.dropzones));if(e.retainDropzones&&e.retainInstance===!1)this.dropzones={};else{var t=Object.keys(this.dropzones),s=[];t.forEach(function(e){if(o(e)){var r=this.dropzones[e].isRegistered=!1;s.push(r)}})}return r(null,n)},e.prototype.hasAnyQueuedFiles=function(){var e=!1;if(this.hasRegisteredDropzones()){var r=Object.keys(this.dropzones);r.forEach(function(r){o(r)&&this.dropzones[r].files.forEach(function(r){return"queued"===r.status?void(e=!0):void 0}),e})}return e},e.prototype.hasRegisteredDropzones=function(){var e=Object.keys(this.dropzones);return 0===e.length?!1:(e.forEach(function(e){var r=this.dropzones[e];return r.isRegistered?!0:void 0}),!1)},e.createDropzone=function(e,r){var n=new Dropzone(e,r);return n},e}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3B6b25lLW1hbmFnZXIuanMiXSwibmFtZXMiOlsiRHJvcHpvbmVNYW5hZ2VyIiwiZHJvcHpvbmVzIiwidGhpcyIsInNlbGYiLCJsZW5ndGgiLCJmb3JFYWNoIiwiZHJvcHpvbmUiLCJyZWdpc3RlciIsImluaXREcm9wem9uZSIsImlzUmVnaXN0ZXJlZCIsImlzRHJvcHpvbmVJbnN0YW5jZSIsIkRyb3B6b25lIiwiaWQiLCJwcm90b3R5cGUiLCJjYWxsYmFjayIsIm9wdGlvbnMiLCJFcnJvciIsInByb2Nlc3NBbGwiLCJvcmRlciIsInVucmVnaXN0ZXIiLCJoYXNSZWdpc3RlcmVkRHJvcHpvbmVzIiwiaWRzIiwiT2JqZWN0Iiwia2V5cyIsInByb2Nlc3NCeUlkIiwiZXJyIiwicHVzaCIsInJlbW92ZUJ5SWQiLCJwYXJhbXMiLCJwcm9jZXNzZWREcm9wem9uZSIsInByb2Nlc3NRdWV1ZSIsInBvc3RVbnJlZ2lzdGVyIiwicmVtb3ZlZERyb3B6b25lIiwicmV0YWluSW5zdGFuY2UiLCJkcm9wenBvbmVzIiwidW5yZWdpc3RlckFsbCIsInVucmVnaXN0ZXJlZERyb3B6b25lcyIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsInJldGFpbkRyb3B6b25lcyIsImhhc0FueVF1ZXVlZEZpbGVzIiwiaGFzUXVldWVkIiwiZmlsZXMiLCJmaWxlIiwic3RhdHVzIiwia2V5IiwiZHoiLCJjcmVhdGVEcm9wem9uZSIsIm5ld0Ryb3B6b25lIl0sIm1hcHBpbmdzIjoiQUFDQSxHQUFBQSxpQkFBQSxXQUNBLFlBRUEsU0FBQUEsR0FBQUMsR0FDQSxNQUFBQyxnQkFBQUYsSUFJQUUsS0FBQUMsS0FBQUQsS0FDQUEsS0FBQUQsa0JBRUFBLEdBQUFBLEVBQUFHLE9BQUEsR0FDQUgsRUFBQUksUUFBQSxTQUFBQyxHQUNBSixLQUFBQyxLQUFBSSxTQUFBRCxPQVJBLEdBQUFOLEdBQUFDLEdBeUNBLFFBQUFPLEdBQUFGLEdBR0FBLEVBQUFHLGNBQUEsRUFvTUEsUUFBQUMsR0FB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UUFBQSxTQUFBTyxHQUNBSCxFQUFBRyxJQUNBVixLQUFBRCxVQUFBVyxHQUFBK0IsTUFBQXRDLFFBQUEsU0FBQXVDLEdBQ0EsTUFBQSxXQUFBQSxFQUFBQyxZQUNBSCxHQUFBLEdBREEsU0FPQUEsSUFJQSxNQUFBQSxJQVNBMUMsRUFBQWEsVUFBQU8sdUJBQUEsV0FDQSxHQUFBRyxHQUFBRCxPQUFBQyxLQUFBckIsS0FBQUQsVUFFQSxPQUFBLEtBQUFzQixFQUFBbkIsUUFDQSxHQUNBbUIsRUFBQWxCLFFBQUEsU0FBQXlDLEdBQ0EsR0FBQUMsR0FBQTdDLEtBQUFELFVBQUE2QyxFQUNBLE9BQUFDLEdBQUF0QyxjQUNBLEVBREEsVUFHQSxJQVNBVCxFQUFBZ0QsZUFBQSxTQUFBcEMsRUFBQUcsR0FFQSxHQUFBa0MsR0FBQSxHQUFBdEMsVUFBQUMsRUFBQUcsRUFFQSxPQUFBa0MsSUFnQkFqRCIsImZpbGUiOiJkcm9wem9uZS1tYW5hZ2VyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG52YXIgRHJvcHpvbmVNYW5hZ2VyID0gKGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHJcblx0ZnVuY3Rpb24gRHJvcHpvbmVNYW5hZ2VyKGRyb3B6b25lcykge1xyXG5cdFx0aWYoISh0aGlzIGluc3RhbmNlb2YgRHJvcHpvbmVNYW5hZ2VyKSlcclxuXHRcdFx0cmV0dXJuIG5ldyBEcm9wem9uZU1hbmFnZXIoZHJvcHpvbmVzKTtcclxuXHRcdFxyXG5cclxuXHRcdHRoaXMuc2VsZiA9IHRoaXM7XHJcblx0XHR0aGlzLmRyb3B6b25lcyA9IHt9OyAvLyBjb252ZXJ0IHRoaXMgdG8gRGljdGlvbmFyeVtpZF0gPSBkcm9wem9uZVxyXG5cclxuXHRcdGlmKGRyb3B6b25lcyAmJiBkcm9wem9uZXMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRkcm9wem9uZXMuZm9yRWFjaChmdW5jdGlvbihkcm9wem9uZSkge1xyXG5cdFx0XHRcdHRoaXMuc2VsZi5yZWdpc3Rlcihkcm9wem9uZSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0XHJcblx0LyoqXHJcblx0KlxyXG5cdCogQWRkcyBhIGRyb3B6b25lIHRvIHRoZSBtYW5hZ2VyXHJcblx0KlxyXG5cdCoqL1xyXG5cdERyb3B6b25lTWFuYWdlci5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbihkcm9wem9uZSwgY2FsbGJhY2spIHtcclxuXHRcdFxyXG5cdFx0aWYoIWNhbGxiYWNrIHx8IGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKXtcclxuXHRcdFx0Y2FsbGJhY2sgPSBmdW5jdGlvbihlcnIsIGRyb3B6b25lKSB7fTtcclxuXHRcdH1cclxuXHJcblx0XHRpZighaXNEcm9wem9uZUluc3RhbmNlKGRyb3B6b25lKSlcclxuXHRcdFx0cmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcignTm90IGEgdmFsaWQgZHJvcHpvbmUgdG8gcmVnaXN0ZXInKSk7XHJcblx0XHRcclxuXHRcdGluaXREcm9wem9uZShkcm9wem9uZSk7IC8vIGluaXRpYWxpemUgdGhlIG5ldyBkcm9wem9uZSwgdGhlbiBhZGRcclxuXHJcblx0XHR0aGlzLmRyb3B6b25lc1tkcm9wem9uZS5vcHRpb25zLmlkXSA9IGRyb3B6b25lOyAvLyBhZGQgdG8gZGljdGlvbmFyeVxyXG5cdFx0XHJcblx0XHRyZXR1cm4gY2FsbGJhY2sobnVsbCwgZHJvcHpvbmUpO1xyXG5cdH07XHJcblxyXG5cclxuXHQvKipcclxuXHQqXHJcblx0KiBBZGQgaXNSZWdpc3RlcmVkIHByb3BlcnR5IG9uIGRyb3B6b25lIG9iamVjdCwgXHJcblx0KlxyXG5cdCoqL1xyXG5cdGZ1bmN0aW9uIGluaXREcm9wem9uZShkcm9wem9uZSkge1xyXG5cdFx0Ly8gVE9ETzogYWRkIGFkZGl0aW9uYWwgcHJvcGVydGllc1xyXG5cdFx0Ly8gXHJcblx0XHRkcm9wem9uZS5pc1JlZ2lzdGVyZWQgPSB0cnVlOyAvLyBhZGQgcmVnaXN0ZXJlZCBwcm9wZXJ0eSBvbiBkcm9wem9uZSBpbnN0YW5jZS5cclxuXHR9XHJcblxyXG5cclxuXHQvKipcclxuXHQqXHJcblx0KiBQcm9jZXNzZXMgYWxsIHJlZ2lzdGVyZWQgZHJvcHpvbmVzIHdpdGggcXVldWVkIGZpbGVzIGZvciB1cGxvYWQuIFxyXG5cdCpcclxuXHQqKi9cclxuXHREcm9wem9uZU1hbmFnZXIucHJvdG90eXBlLnByb2Nlc3NBbGwgPSBmdW5jdGlvbihvcHRpb25zLCBjYWxsYmFjaykgeyAvLyBUT0RPIGFkZCBvcHRpb24gdG8gdW5yZWdpc3RlciBwb3N0IHByb2Nlc3NcclxuXHRcdGlmKCFjYWxsYmFjayAmJiB0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xyXG5cdFx0XHRjYWxsYmFjayA9IG9wdGlvbnM7XHJcblx0XHRcdG9wdGlvbnMgPSB7XHJcblx0XHRcdFx0b3JkZXIgOiAnQVNDJyxcclxuXHRcdFx0XHR1bnJlZ2lzdGVyIDogZmFsc2VcclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0aWYoIXRoaXMuaGFzUmVnaXN0ZXJlZERyb3B6b25lcygpKVxyXG5cdFx0XHRyZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKFwiTWFuYWdlciBoYXMgbm8gZHJvcHpvbmVzIHJlZ2lzdGVyZWRcIikpO1xyXG5cclxuXHRcdHZhciBpZHMgPSBPYmplY3Qua2V5cyh0aGlzLmRyb3B6b25lcyk7XHJcblx0XHR2YXIgZHJvcHpvbmVzID0gW107XHJcblx0XHQvLyBUT0RPIGFkZCBwcm9jZXNzIG9yZGVyIEFTQyBhbmQgREVTQ1xyXG5cdFx0aWRzLmZvckVhY2goZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0Ly8gY2hlY2sgaWYgdGhlIGRyb3B6b25lIGlzIHJlZ2lzdGVyZWQgd2l0aCBpZFxyXG5cdFx0XHRpZihpc1JlZ2lzdGVyZWQoaWQpKSBcclxuXHRcdFx0XHR0aGlzLnByb2Nlc3NCeUlkKGlkLCBmdW5jdGlvbihlcnIsIGRyb3B6b25lKSB7XHJcblx0XHRcdFx0XHRpZighZXJyKSBkcm9wem9uZXMucHVzaChkcm9wem9uZSk7XHJcblx0XHRcdFx0XHRpZihvcHRpb25zLnVucmVnaXN0ZXIpe1xyXG5cdFx0XHRcdFx0XHR0aGlzLnJlbW92ZUJ5SWQoeyBpZDogaWQgfSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBnZXQgY29sbGVjdGlvbiBvZiBkcm9wem9uZXMgdGhhdCB3ZXJlIHByb2Nlc3NlZFxyXG5cdFx0Ly8gcGFzcyBpbiBjYWxsYmFja1xyXG5cdFx0cmV0dXJuIGNhbGxiYWNrKG51bGwsIGRyb3B6b25lcyk7XHJcblx0fTtcclxuXHJcblxyXG5cdC8qKlxyXG5cdCpcclxuXHQqIFByb2Nlc3NlcyB0aGUgcXVldWUgb2YgYSBzcGVjaWZpYyByZWdpc3RlcmVkIGRyb3B6b25lIHdpdGggaWRcclxuXHQqXHJcblx0KiovXHJcblx0RHJvcHpvbmVNYW5hZ2VyLnByb3RvdHlwZS5wcm9jZXNzQnlJZCA9IGZ1bmN0aW9uKHBhcmFtcywgY2FsbGJhY2spIHsgLy8gVE9ETyBhZGQgb3B0aW9uLCBleC4gdW5yZWdpc3RlciBhZnRlciBwcm9jZXNzXHJcblx0XHRpZighY2FsbGJhY2sgfHwgdHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdGNhbGxiYWNrID0gZnVuY3Rpb24oZXJyLCBkcm9wem9uZSkgeyB9O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCF0aGlzLmhhc1JlZ2lzdGVyZWREcm9wem9uZXMoKSlcclxuXHRcdFx0cmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcihcIk1hbmFnZXIgaGFzIG5vIGRyb3B6b25lcyByZWdpc3RlcmVkXCIpKTtcclxuXHJcblx0XHRpZighaXNSZWdpc3RlcmVkKHRoaXMuZHJvcHpvbmVzLCBwYXJhbXMuaWQpKVxyXG5cdFx0XHRyZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCdcIicgKyBwYXJhbXMuaWQgKyAnXCIgaXMgbm90IGEgcmVnaXN0ZXJlZCBEcm9wem9uZScpKTtcclxuXHJcblx0XHR2YXIgcHJvY2Vzc2VkRHJvcHpvbmUgPSB0aGlzLmRyb3B6b25lc1twYXJhbXMuaWRdO1xyXG5cdFx0cHJvY2Vzc2VkRHJvcHpvbmUucHJvY2Vzc1F1ZXVlKCk7XHJcblx0XHRpZihwYXJhbXMucG9zdFVucmVnaXN0ZXIpe1xyXG5cdFx0XHR0aGlzLmRyb3B6b25lc1twYXJhbXMuaWRdLmlzUmVnaXN0ZXJlZCA9IGZhbHNlOyAvLyB1bnJlZ2lzdGVyIGlmIHBhcmFtIHBvc3QgdW5yZWdpc3RlciBpcyB0cnVlXHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGNhbGxiYWNrKG51bGwsIHByb2Nlc3NlZERyb3B6b25lKTsgLy8gcmV0dXJuIHByb2Nlc3NlZCBkcm9wem9uZVxyXG5cdH07XHJcblxyXG5cclxuXHQvKipcclxuXHQqXHJcblx0KiBDbGVhcnMgb3V0IHRoZSBtYW5hZ2VyIG9mIHJlZ2lzdGVyZWQgZHJvcHpvbmUgd2l0aCBzcGVjaWZpZWQgaWRcclxuXHQqXHJcblx0KiovXHJcblx0RHJvcHpvbmVNYW5hZ2VyLnByb3RvdHlwZS5yZW1vdmVCeUlkID0gZnVuY3Rpb24ocGFyYW1zLCBjYWxsYmFjaykgeyAvLyBUT0RPIGFkZCByZXRhaW5EWiBpbnN0YW5jZSBvcHRpb25cclxuXHRcdGlmKCFjYWxsYmFjayB8fCB0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0Y2FsbGJhY2sgPSBmdW5jdGlvbihlcnIsIGRyb3B6b25lKSB7IH07XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoIXRoaXMuaGFzUmVnaXN0ZXJlZERyb3B6b25lcygpKVxyXG5cdFx0XHRyZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCdNYW5hZ2VyIGhhcyBubyBkcm9wem9uZXMgcmVnaXN0ZXJlZCcpLCBudWxsKTtcclxuXHJcblx0XHQvLyBUT0RPIGZpbmlzaFxyXG5cdFx0Ly8gQ2hlY2sgaWYgaWQgaXMgcmVnaXN0ZXJlZCBcclxuXHRcdGlmKGlzUmVnaXN0ZXJlZCh0aGlzLmRyb3B6b25lcywgcGFyYW1zLmlkKSlcclxuXHRcdFx0cmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcignXCInICsgcGFyYW1zLmlkICsgJ1wiIGlzIG5vdCBhIHJlZ2lzdGVyZWQgRHJvcHpvbmUnKSk7XHJcblxyXG5cdFx0dmFyIHJlbW92ZWREcm9wem9uZSA9IHRoaXMuZHJvcHpvbmVzW3BhcmFtcy5pZF07XHJcblx0XHRpZihwYXJhbXMucmV0YWluSW5zdGFuY2UgPT09IHRydWUpIHtcclxuXHRcdFx0dGhpcy5kcm9wenBvbmVzW3BhcmFtcy5pZF0uaXNSZWdpc3RlcmVkID0gZmFsc2U7IC8vIGtlZXAgaW4gY29sbGVjdGlvbiwgcmVtb3ZlIHJlZ2lzdGVyZWQgZmxhZ1xyXG5cdFx0fSBlbHNlIHsgXHJcblx0XHRcdGRlbGV0ZSB0aGlzLmRyb3B6b25lc1twYXJhbXMuaWRdOyAvLyByZW1vdmUgZnJvbSBjb2xsZWN0aW9uXHJcblx0XHR9XHJcblx0XHRyZXR1cm4gY2FsbGJhY2sobnVsbCwgcmVtb3ZlZERyb3B6b25lKTtcclxuXHR9O1xyXG5cclxuXHJcblx0LyoqXHJcblx0KiBcclxuXHQqIENsZWFycyBvdXQgdGhlIG1hbmFnZXIgb2YgYWxsIGRyb3B6b25lcyByZWdpc3RlcmVkIHdpdGggY2FsbGJhY2sgcmV0dXJuaW5nIHRoZSBkcm9wem9uZXNcclxuXHQqIE8oMSlcclxuXHQqIFxyXG5cdCoqL1xyXG5cdERyb3B6b25lTWFuYWdlci5wcm90b3R5cGUudW5yZWdpc3RlckFsbCA9IGZ1bmN0aW9uKG9wdGlvbnMsIGNhbGxiYWNrKSB7XHJcblx0XHRpZighY2FsbGJhY2sgJiYgdHlwZW9mIG9wdGlvbnMgPT09ICdmdW5jdGlvbicpe1xyXG5cdFx0XHRjYWxsYmFjayA9IG9wdGlvbnM7XHJcblx0XHRcdG9wdGlvbnMgPSB7XHJcblx0XHRcdFx0cmV0YWluSW5zdGFuY2UgOiBmYWxzZVxyXG5cdFx0XHR9O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCF0aGlzLmhhc1JlZ2lzdGVyZWREcm9wem9uZXMoKSkgXHJcblx0XHRcdHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoJ01hbmFnZXIgaGFzIG5vIGRyb3B6b25lcyByZWdpc3RlcmVkLicpKTtcclxuXHJcblx0XHR2YXIgdW5yZWdpc3RlcmVkRHJvcHpvbmVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmRyb3B6b25lcykpOyAvLyBjcmVhdGUgYW4gdW5yZWZlcmVuY2VkIGNvcHlcclxuXHRcdFxyXG5cdFx0aWYob3B0aW9ucy5yZXRhaW5Ecm9wem9uZXMgJiYgb3B0aW9ucy5yZXRhaW5JbnN0YW5jZSA9PT0gZmFsc2UpeyAvLyByZW1vdmUgYWxsIHRyYWNlIG9mIGRyb3B6b25lc1xyXG5cdFx0XHR0aGlzLmRyb3B6b25lcyA9IHt9OyAvLyByZXNldCB0byBlbXB0eSBvYmplY3QgZGljdGlvbmFyeVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHZhciBpZHMgPSBPYmplY3Qua2V5cyh0aGlzLmRyb3B6b25lcyk7XHJcblx0XHRcdHZhciBkcm9wem9uZXMgPSBbXTtcclxuXHRcdFx0aWRzLmZvckVhY2goZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0XHQvLyBjaGVjayBpZiB0aGUgZHJvcHpvbmUgaXMgcmVnaXN0ZXJlZCB3aXRoIGlkXHJcblx0XHRcdFx0aWYoaXNSZWdpc3RlcmVkKGlkKSkge1xyXG5cdFx0XHRcdFx0dmFyIGRyb3B6b25lID0gdGhpcy5kcm9wem9uZXNbaWRdLmlzUmVnaXN0ZXJlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0ZHJvcHpvbmVzLnB1c2goZHJvcHpvbmUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGNhbGxiYWNrKG51bGwsIHVucmVnaXN0ZXJlZERyb3B6b25lcyk7IC8vIHJldHVybiBhbGwgZHJvcHpvbmVzIHRoYXQgZ290IHJlbW92ZWRcclxuXHR9O1xyXG5cclxuXHJcblx0LyoqXHJcblx0KlxyXG5cdCogQ2hlY2tzIGlmIGFueSBkcm9wem9uZSBpbiB0aGUgbWFuYWdlciBoYXMgcGVuZGluZyBmaWxlcyBmb3IgdXBsb2FkXHJcblx0KiBPKG4pXHJcblx0KiBcclxuXHQqKi9cclxuXHREcm9wem9uZU1hbmFnZXIucHJvdG90eXBlLmhhc0FueVF1ZXVlZEZpbGVzID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgaGFzUXVldWVkID0gZmFsc2U7XHJcblxyXG5cdFx0Ly8gQ2hlY2sgaWYgdGhlcmUncyBhbnkgcmVnaXN0ZXJlZCBkcm9wem9uZXMgZmlyc3QuIFJldHVybiBmYWxzZSBpZiBub25lLlxyXG5cdFx0aWYodGhpcy5oYXNSZWdpc3RlcmVkRHJvcHpvbmVzKCkpIHtcclxuXHRcdFx0dmFyIGlkcyA9IE9iamVjdC5rZXlzKHRoaXMuZHJvcHpvbmVzKTsgLy8gZ2V0IGFsbCB0aGUga2V5c1xyXG5cclxuXHRcdFx0aWRzLmZvckVhY2goZnVuY3Rpb24oaWQpIHtcclxuXHRcdFx0XHRpZihpc1JlZ2lzdGVyZWQoaWQpKSB7XHJcblx0XHRcdFx0XHR0aGlzLmRyb3B6b25lc1tpZF0uZmlsZXMuZm9yRWFjaChmdW5jdGlvbihmaWxlKSB7XHJcblx0XHRcdFx0XHRcdGlmIChmaWxlLnN0YXR1cyA9PT0gXCJxdWV1ZWRcIikge1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgaGFzUXVldWVkID0gdHJ1ZTtcclxuXHRcdFx0ICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHRcdCAgICAgICAgICAgIFx0fSAgICAgICAgICAgIFx0XHRcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYoaGFzUXVldWVkKSByZXR1cm47XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHQgICAgcmV0dXJuIGhhc1F1ZXVlZDtcclxuXHR9O1xyXG5cclxuXHJcblx0LyoqXHJcblx0KlxyXG5cdCogQ2hlY2sgZm9yIGFueSBkcm9wem9uZXMgaW4gbWFuYWdlclxyXG5cdCpcclxuXHQqKi9cclxuXHREcm9wem9uZU1hbmFnZXIucHJvdG90eXBlLmhhc1JlZ2lzdGVyZWREcm9wem9uZXMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBrZXlzID0gT2JqZWN0LmtleXModGhpcy5kcm9wem9uZXMpO1xyXG5cclxuXHRcdGlmKGtleXMubGVuZ3RoID09PSAwKVxyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRrZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XHJcblx0XHRcdHZhciBkeiA9IHRoaXMuZHJvcHpvbmVzW2tleV07XHJcblx0XHRcdGlmKGR6LmlzUmVnaXN0ZXJlZCkgXHJcblx0XHRcdFx0cmV0dXJuIHRydWU7IC8vIHJldHVybiBvbiBmaXJzdCBpbnN0YW5jZSBvZiBhIHJlZ2lzdGVyZWQgZHJvcHpvbmVcclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH07XHJcblxyXG5cclxuXHQvKipcclxuXHQqXHJcblx0KiBGYWN0b3J5IG1ldGhvZCB0byBjcmVhdGUgZHJvcHpvbmVzXHJcblx0KlxyXG5cdCoqL1xyXG5cdERyb3B6b25lTWFuYWdlci5jcmVhdGVEcm9wem9uZSA9IGZ1bmN0aW9uKGlkLCBvcHRpb25zKSB7XHJcblx0XHQvLyBUT0RPIFByb3h5IHRvIGFkZCBhZGRpdGlvbmFsIHByb3BlcnRpZXMgYW5kIHZhbGlkYXRpb25cclxuXHRcdHZhciBuZXdEcm9wem9uZSA9IG5ldyBEcm9wem9uZShpZCwgb3B0aW9ucyk7XHJcblxyXG5cdFx0cmV0dXJuIG5ld0Ryb3B6b25lO1xyXG5cdH07XHJcblxyXG5cdGZ1bmN0aW9uIGlzRHJvcHpvbmVJbnN0YW5jZShkcm9wem9uZSkge1xyXG5cdFx0cmV0dXJuIChkcm9wem9uZSBpbnN0YW5jZW9mIERyb3B6b25lKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCpcclxuXHQqIENoZWNrIGlmIGRyb3B6b25lIGlzIHJlZ2lzdGVyZWQgd2l0aCB0aGF0IGlkLlxyXG5cdCpcclxuXHQqKi9cclxuXHRmdW5jdGlvbiBpc1JlZ2lzdGVyZWQoZHJvcHpvbmVzLCBpZCkge1xyXG5cdFx0cmV0dXJuIGRyb3B6b25lc1tpZF0gIT09IFwidW5kZWZpbmVkXCIgJiYgaXNEcm9wem9uZUluc3RhbmNlKGRyb3B6b25lc1tpZF0pO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIERyb3B6b25lTWFuYWdlcjtcclxuXHJcbn0pKCk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==